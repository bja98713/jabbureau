{% extends 'base.html' %}
{% block title %}Patients{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Patients</h2>
</div>

<form method="get" class="mb-3">
  <div class="form-row align-items-end">
    <div class="col-md-6">
      <label for="q">Rechercher un patient</label>
      <input type="text" id="q" name="q" value="{{ q|default:'' }}" class="form-control" placeholder="DN, nom, prénom ou date (JJ/MM/AAAA ou AAAA-MM-JJ)">
    </div>
    <div class="col-md-3">
      <button type="submit" class="btn btn-outline-primary">Rechercher</button>
      <a href="{% url 'patients_list' %}" class="btn btn-link">Réinitialiser</a>
    </div>
  </div>
</form>

<table class="table table-striped table-sm">
  <thead class="thead-light">
    <tr>
      <th>DN</th>
      <th>Nom</th>
      <th>Prénom</th>
      <th>Date de naissance</th>
  <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for p in patients %}
      <tr>
        <td>{{ p.dn }}</td>
        <td>{{ p.nom }}</td>
        <td>{{ p.prenom }}</td>
        <td>{% if p.date_naissance %}{{ p.date_naissance|date:'d/m/Y' }}{% endif %}</td>
        <td>
          <a class="btn btn-sm btn-outline-dark" href="{% url 'patients_detail' p.dn %}">Fiche</a>
          <a class="btn btn-sm btn-outline-danger" href="{% url 'patient_delete' p.dn %}">Supprimer</a>
          <a class="btn btn-sm btn-outline-primary" href="{% url 'observations_by_dn' p.dn %}">Observations</a>
          <a class="btn btn-sm btn-outline-secondary" href="{% url 'observations_pdf' p.dn %}" target="_blank">PDF Observations</a>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="5" class="text-center">Aucun patient trouvé.</td></tr>
    {% endfor %}
  </tbody>
</table>

 
{% endblock %}
