{% extends 'base.html' %}
{% block title %}Patients hospitalisés{% endblock %}

{% block content %}
<h2>Patients hospitalisés le {{ today_formatted|date:"d/m/Y" }}</h2>

<div class="mb-3">
  <a href="{% url 'patients_hospitalises_pdf' %}" class="btn btn-outline-primary">Impression PDF</a>
  <a href="{% url 'patients_hospitalises_excel' %}" class="btn btn-outline-success">Export Excel</a>
</div>

<style>
  .highlight-nosortie {
    background-color: #fff3cd !important;
  }
</style>

<h3>Bloc</h3>
<table class="table table-bordered">
  <tr><th>DN</th><th>Nom</th><th>Prénom</th><th>Date de naissance</th><th>Date d'entrée</th><th>Date sortie théorique</th><th>Date de sortie</th></tr>
  {% for p in bloc %}
  <tr{% if not p.date_sortie %} class="highlight-nosortie"{% endif %}>
    <td>{{ p.dn }}</td>
    <td>{{ p.nom }}</td>
    <td>{{ p.prenom }}</td>
    <td>{{ p.date_naissance|date:"d/m/Y" }}</td>
    <td>{{ p.date_entree|date:"d/m/Y" }}</td>
    <td>{{ p.date_sortie_theorique|date:"d/m/Y" }}</td>
    <td>{{ p.date_sortie|date:"d/m/Y" }}</td>
  </tr>
  {% endfor %}
</table>

<h3>Médecine</h3>
<table class="table table-bordered">
  <tr><th>DN</th><th>Nom</th><th>Prénom</th><th>Date de naissance</th><th>Date d'entrée</th><th>Date sortie théorique</th><th>Date de sortie</th></tr>
  {% for p in medecine %}
  <tr{% if not p.date_sortie %} class="highlight-nosortie"{% endif %}>
    <td>{{ p.dn }}</td>
    <td>{{ p.nom }}</td>
    <td>{{ p.prenom }}</td>
    <td>{{ p.date_naissance|date:"d/m/Y" }}</td>
    <td>{{ p.date_entree|date:"d/m/Y" }}</td>
    <td>{{ p.date_sortie_theorique|date:"d/m/Y" }}</td>
    <td>{{ p.date_sortie|date:"d/m/Y" }}</td>
  </tr>
  {% endfor %}
</table>

<h3>Soins continus</h3>
<table class="table table-bordered">
  <tr><th>DN</th><th>Nom</th><th>Prénom</th><th>Date de naissance</th><th>Date d'entrée</th><th>Date sortie théorique</th><th>Date de sortie</th></tr>
  {% for p in soins_continus %}
  <tr{% if not p.date_sortie %} class="highlight-nosortie"{% endif %}>
    <td>{{ p.dn }}</td>
    <td>{{ p.nom }}</td>
    <td>{{ p.prenom }}</td>
    <td>{{ p.date_naissance|date:"d/m/Y" }}</td>
    <td>{{ p.date_entree|date:"d/m/Y" }}</td>
    <td>{{ p.date_sortie_theorique|date:"d/m/Y" }}</td>
    <td>{{ p.date_sortie|date:"d/m/Y" }}</td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
